<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boceto - ¿Qué Cocino Hoy?</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" xintegrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        #app-container {
            flex-grow: 1;
        }
        .card-enter, .page-enter {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeIn 0.5s ease-out forwards;
        }
        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        /* Estilo para el checklist de ingredientes */
        .ingredient-item input:checked + span {
            text-decoration: line-through;
            color: #9ca3af; /* gray-400 */
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div id="app-container" class="container mx-auto p-4 md:p-8 max-w-4xl">

        <!-- ==================================================== -->
        <!-- ============== PÁGINA PRINCIPAL (BUSCADOR) ========= -->
        <!-- ==================================================== -->
        <div id="pagina-principal">
            <header class="text-center my-8 md:my-12">
                <h1 class="text-4xl md:text-5xl font-bold text-orange-600">¿Qué Cocino Hoy?</h1>
                <p class="mt-4 text-lg md:text-xl text-gray-600">Dime qué tienes en la heladera y te doy ideas frescas y rápidas.</p>
            </header>

            <main>
                <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg max-w-lg mx-auto">
                    <div class="space-y-6">
                        <div>
                            <label for="ingredientes" class="block text-sm font-medium text-gray-700 mb-2">Ingresa uno o dos ingredientes principales</label>
                            <input type="text" id="ingredientes" placeholder="Ej: Lentejas, pollo, palta..." class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition">
                        </div>
                        <div>
                            <label for="comensales" class="block text-sm font-medium text-gray-700 mb-2">¿Cuántos son a la mesa?</label>
                            <input type="number" id="comensales" value="2" min="1" max="12" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition">
                        </div>
                        <div>
                            <button id="buscar-btn" class="w-full bg-orange-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition-transform transform hover:scale-105">
                                ¡Dame Ideas!
                            </button>
                        </div>
                        <!-- INICIO DEL CAMBIO: Botón "Sorpréndeme" -->
                        <div class="text-center">
                            <span class="text-sm text-gray-500">¿No sabes qué buscar?</span>
                            <button id="sorprendeme-btn" class="text-orange-600 font-semibold hover:underline ml-1">
                                <i class="fa-solid fa-wand-magic-sparkles mr-1"></i>Sorpréndeme
                            </button>
                        </div>
                        <!-- FIN DEL CAMBIO -->
                    </div>
                </div>
            </main>
        </div>

        <!-- ==================================================== -->
        <!-- ============== PÁGINA DE RESULTADOS (OCULTA) ======= -->
        <!-- ==================================================== -->
        <div id="pagina-resultados" class="hidden">
            <header class="mb-8">
                 <button id="volver-a-buscar-btn" class="text-orange-600 hover:text-orange-800 font-semibold">&larr; Volver a buscar</button>
                 <h2 id="resultados-titulo" class="text-center text-2xl md:text-3xl font-bold text-gray-800 mt-4"></h2>
            </header>

            <main id="cards-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
                <!-- Las tarjetas de recetas se insertarán aquí -->
            </main>
        </div>

        <!-- ==================================================== -->
        <!-- ============== PÁGINA DE RECETA COMPLETA (OCULTA) == -->
        <!-- ==================================================== -->
        <div id="pagina-receta-completa" class="hidden">
            <header class="mb-8">
                <button id="volver-a-resultados-btn" class="text-orange-600 hover:text-orange-800 font-semibold">&larr; Volver a los resultados</button>
            </header>
            <main id="receta-contenido" class="bg-white rounded-2xl shadow-lg overflow-hidden page-enter">
                <!-- El contenido de la receta se insertará aquí -->
            </main>
        </div>

    </div>

    <!-- ==================================================== -->
    <!-- ============== FOOTER ============================== -->
    <!-- ==================================================== -->
    <footer class="text-center py-6">
        <p class="text-sm text-gray-500">
            Desarrollado en el marco de la Formación en IA aplicada a Contextos Organizacionales de 
            <a href="https://codeki.com.ar/ia-aplicada-a-contextos-organizacionales/" target="_blank" rel="noopener noreferrer" class="underline text-orange-600 hover:text-orange-800">Codeki</a>.
        </p>
        <div class="mt-2">
            <a href="https://drive.google.com/file/d/1kxD3IIVSG7rOe3Mwwac1aGXFOWMwMwMl/view?usp=drive_link" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 underline hover:text-blue-800">Ver cómo</a>
        </div>
    </footer>


    <script>
        // --- ELEMENTOS DEL DOM ---
        const paginaPrincipal = document.getElementById('pagina-principal');
        const paginaResultados = document.getElementById('pagina-resultados');
        const paginaRecetaCompleta = document.getElementById('pagina-receta-completa');
        
        const buscarBtn = document.getElementById('buscar-btn');
        const volverABuscarBtn = document.getElementById('volver-a-buscar-btn');
        const volverAResultadosBtn = document.getElementById('volver-a-resultados-btn');
        const sorprendemeBtn = document.getElementById('sorprendeme-btn'); // <-- Nuevo elemento
        
        const resultadosTitulo = document.getElementById('resultados-titulo');
        const cardsContainer = document.getElementById('cards-container');
        const recetaContenido = document.getElementById('receta-contenido');
        const ingredientesInput = document.getElementById('ingredientes');
        const comensalesInput = document.getElementById('comensales');

        // --- BASE DE DATOS ---
        const baseDeRecetas = [
            {
                id: "bunuelos-acelga",
                titulo: "Buñuelos de Acelga Esponjosos",
                ingredientesClave: ["acelga"],
                descripcion: "La receta clásica de la abuela, ¡pero más fácil! Perfectos como entrada o para picar.",
                porcionesBase: 4,
                ingredientes: [ { cantidad: "1", unidad: "atado", nombre: "Acelga" }, { cantidad: "2", unidad: "", nombre: "Huevos" }, { cantidad: "1", unidad: "taza", nombre: "Harina leudante" }, { cantidad: "2", unidad: "dientes", nombre: "Ajo picado" }, { cantidad: "a gusto", unidad: "", nombre: "Sal y perejil" }, { cantidad: "c/n", unidad: "", nombre: "Aceite para freír" } ],
                pasos: ["Lava bien la acelga y cocínala en agua hirviendo por 3 minutos. Escúrrela muy bien y pícala chiquita.", "En un bol, mezcla la acelga picada con los huevos, el ajo y el perejil.", "Incorpora la harina de a poco, mezclando hasta que no queden grumos. La mezcla debe quedar espesa.", "Calienta abundante aceite en una sartén. Con una cuchara, ve echando porciones de la mezcla.", "Fríe los buñuelos hasta que estén dorados por ambos lados. Retíralos y déjalos escurrir sobre papel de cocina."],
                tiempoPrep: "15 min",
                tiempoCoccion: "10 min",
                imagenUrl: "images/bunuelos-de-acelga2.jpg"
            },
            {
                id: "bastones-batata",
                titulo: "Bastones de Batata al Horno",
                ingredientesClave: ["batata", "boniato", "papa"],
                descripcion: "Más sanos que las papas fritas y con un toque dulce que te va a encantar.",
                porcionesBase: 2,
                ingredientes: [{ cantidad: "2", unidad: "grandes", nombre: "Batatas" }, { cantidad: "2", unidad: "cdas", nombre: "Aceite de oliva" }, { cantidad: "1", unidad: "cdita", nombre: "Pimentón dulce" }, { cantidad: "a gusto", unidad: "", nombre: "Sal y pimienta" }],
                pasos: ["Precalienta el horno a 200°C.", "Lava bien las batatas y córtalas en bastones, como si fueran papas fritas. Puedes dejarles la piel.", "En un bol grande, mezcla los bastones de batata con el aceite de oliva, el pimentón, la sal y la pimienta. Asegúrate de que queden bien cubiertos.", "Distribuye los bastones en una sola capa sobre una bandeja para horno con papel manteca.", "Hornea durante 25-30 minutos, dándolos vuelta a la mitad del tiempo, hasta que estén dorados y tiernos por dentro."],
                tiempoPrep: "10 min",
                tiempoCoccion: "30 min",
                imagenUrl: "images/bastones-de-batata.jpg"
            },
            {
                id: "pollo-al-horno-papas",
                titulo: "Pollo al Horno con Papas y Romero",
                descripcion: "Un clásico infalible que llena la casa de un aroma increíble. Tierno por dentro y dorado por fuera.",
                ingredientesClave: ["pollo", "papa", "cebolla"],
                porcionesBase: 4,
                tiempoPrep: "15 min",
                tiempoCoccion: "1 hora",
                imagenUrl: "images/pollo-con-papas.jpg",
                ingredientes: [{ cantidad: "4", unidad: "patas de", nombre: "Pollo" }, { cantidad: "4", unidad: "medianas", nombre: "Papas" }, { cantidad: "2", unidad: "", nombre: "Cebollas" }, { cantidad: "3", unidad: "dientes", nombre: "Ajo" }, { cantidad: "a gusto", unidad: "", nombre: "Romero fresco" }, { cantidad: "c/n", unidad: "", nombre: "Aceite de oliva, sal y pimienta" }],
                pasos: ["Precalentar el horno a 200°C.", "Pelar las papas y cortarlas en rodajas gruesas. Cortar la cebolla en juliana.", "En una fuente para horno, colocar las papas y la cebolla. Rociar con aceite, sal y pimienta.", "Colocar las patas de pollo sobre las verduras. Salpimentar, añadir los ajos machacados y las ramas de romero.", "Hornear durante 1 hora o hasta que el pollo esté cocido y las papas doradas."]
            },
            {
                id: "ensalada-garbanzos-palta",
                titulo: "Ensalada Fresca de Garbanzos y Palta",
                descripcion: "Una ensalada completa, rápida y llena de nutrientes. Ideal para un almuerzo ligero.",
                ingredientesClave: ["garbanzo", "palta", "tomate", "cebolla"],
                porcionesBase: 2,
                tiempoPrep: "10 min",
                tiempoCoccion: "0 min",
                imagenUrl: "images/ensalada-de-garbanzos.jpg",
                ingredientes: [{ cantidad: "1", unidad: "lata de", nombre: "Garbanzos cocidos" }, { cantidad: "1", unidad: "grande", nombre: "Palta" }, { cantidad: "2", unidad: "", nombre: "Tomates perita" }, { cantidad: "0.5", unidad: "", nombre: "Cebolla morada" }, { cantidad: "a gusto", unidad: "", nombre: "Jugo de limón, aceite de oliva, sal" }],
                pasos: ["Escurrir y enjuagar bien los garbanzos de lata.", "Cortar la palta y los tomates en cubos. Picar la cebolla morada bien chiquita.", "En un bol, mezclar todos los ingredientes con cuidado.", "Aderezar con abundante jugo de limón, un chorrito de aceite de oliva y sal.", "Servir inmediatamente para que la palta no se oxide."]
            },
            {
                id: "guiso-lentejas",
                titulo: "Guiso de Lentejas Clásico",
                descripcion: "Un plato potente y reconfortante, ideal para los días de frío. Lleno de sabor y nutrientes.",
                ingredientesClave: ["lentejas", "zanahoria", "papa", "cebolla", "morrón", "carne"],
                porcionesBase: 6,
                tiempoPrep: "20 min",
                tiempoCoccion: "50 min",
                imagenUrl: "images/guiso-de-lentejas.jpg",
                ingredientes: [{ cantidad: "500", unidad: "gr", nombre: "Lentejas" }, { cantidad: "250", unidad: "gr", nombre: "Carne para guiso (paleta, roast beef)" }, { cantidad: "1", unidad: "", nombre: "Cebolla" }, { cantidad: "1", unidad: "", nombre: "Zanahoria" }, { cantidad: "1", unidad: "", nombre: "Papa" }, { cantidad: "0.5", unidad: "", nombre: "Morrón rojo" }, { cantidad: "1", unidad: "diente", nombre: "Ajo" }, { cantidad: "1", "unidad": "hoja", nombre: "Laurel" }, { cantidad: "c/n", unidad: "", nombre: "Caldo de verduras, sal, pimentón" }],
                pasos: ["Si usas lentejas secas, remójalas desde la noche anterior. Si no, puedes usar de lata al final.", "Corta la carne en cubos y dórala en una olla grande con un poco de aceite. Retira y reserva.", "En la misma olla, sofríe la cebolla, el morrón y el ajo picados. Añade la zanahoria en rodajas.", "Incorpora la carne de nuevo, las lentejas escurridas, la papa en cubos y la hoja de laurel.", "Cubre todo con caldo caliente, condimenta con sal y pimentón. Cocina a fuego bajo por 45-50 minutos, hasta que todo esté tierno."]
            },
            {
                id: "tarta-espinaca",
                titulo: "Tarta de Espinaca y Ricota",
                descripcion: "La clásica tarta Pascualina, cremosa y deliciosa. Perfecta para una comida o para llevar.",
                ingredientesClave: ["espinaca", "cebolla"],
                porcionesBase: 8,
                tiempoPrep: "25 min",
                tiempoCoccion: "40 min",
                imagenUrl: "images/tarta-de-espinaca.jpg",
                ingredientes: [{ cantidad: "2", unidad: "atados", nombre: "Espinaca" }, { cantidad: "300", unidad: "gr", nombre: "Ricota" }, { cantidad: "1", unidad: "", nombre: "Cebolla" }, { cantidad: "100", unidad: "gr", nombre: "Queso rallado" }, { cantidad: "2", unidad: "", nombre: "Huevos" }, { cantidad: "1", unidad: "tapa de", nombre: "Masa para tarta (tipo Pascualina)" }],
                pasos: ["Lava y cocina la espinaca al vapor o en agua hirviendo por 2 minutos. Escúrrela muy bien y pícala.", "Sofríe la cebolla picada hasta que esté transparente.", "En un bol, mezcla la espinaca, la ricota, la cebolla, el queso rallado y un huevo. Salpimenta a gusto.", "Forra una tartera con la masa. Vierte el relleno sobre la masa.", "Opcional: haz huecos en el relleno y coloca huevos crudos. Pinta los bordes con huevo batido.", "Hornea a 180°C durante 35-40 minutos, hasta que la masa esté dorada y el relleno firme."]
            },
            {
                id: "pescado-con-arroz",
                titulo: "Pescado a la Plancha con Arroz",
                descripcion: "Una comida ligera, saludable y muy rápida de preparar. El pescado queda jugoso y el arroz es la guarnición perfecta.",
                ingredientesClave: ["pescado", "arroz", "limón"],
                porcionesBase: 2,
                tiempoPrep: "10 min",
                tiempoCoccion: "20 min",
                imagenUrl: "images/merluza-con-arroz.jpg",
                ingredientes: [{ cantidad: "2", unidad: "filetes de", nombre: "Pescado blanco (merluza, lenguado)" }, { cantidad: "1", unidad: "taza de", nombre: "Arroz" }, { cantidad: "1", unidad: "", nombre: "Limón" }, { cantidad: "a gusto", unidad: "", nombre: "Perejil fresco" }, { cantidad: "c/n", unidad: "", nombre: "Aceite de oliva, sal y pimienta" }],
                pasos: ["Cocina el arroz siguiendo las instrucciones del paquete (generalmente 1 taza de arroz por 2 de agua).", "Mientras se cocina el arroz, calienta una plancha o sartén grande con un chorrito de aceite de oliva.", "Salpimenta los filetes de pescado por ambos lados.", "Cocina el pescado a fuego medio-alto, unos 3-4 minutos por lado, hasta que esté dorado y se desarme fácilmente.", "Sirve el pescado sobre una cama de arroz, rocía con abundante jugo de limón y espolvorea con perejil picado."]
            }
        ];

        // --- LÓGICA DE NAVEGACIÓN Y RENDERIZADO ---

        function mostrarPagina(paginaAMostrar) {
            paginaPrincipal.classList.add('hidden');
            paginaResultados.classList.add('hidden');
            paginaRecetaCompleta.classList.add('hidden');
            paginaAMostrar.classList.remove('hidden');
        }

        function buscarRecetas() {
            const userInput = ingredientesInput.value.toLowerCase().trim();
            if (!userInput) {
                alert("Por favor, ingresa al menos un ingrediente.");
                return;
            }
            
            const ingredientesBuscados = userInput.split(',').map(item => item.trim());
            
            const recetasFiltradas = baseDeRecetas.filter(r =>
              ingredientesBuscados.some(ing =>
                r.ingredientesClave.some(k => k.includes(ing) || ing.includes(k))
              )
            );
            
            mostrarPagina(paginaResultados);
            const comensales = comensalesInput.value || 2;
            resultadosTitulo.textContent = `Ideas con "${userInput}" para ${comensales} personas:`;
            cardsContainer.innerHTML = '';

            if (recetasFiltradas.length > 0) {
                recetasFiltradas.forEach((receta, index) => {
                    const card = document.createElement('div');
                    card.className = 'bg-white rounded-2xl shadow-lg flex flex-col card-enter overflow-hidden';
                    card.style.animationDelay = `${index * 100}ms`;
                    
                    card.innerHTML = `
                        <img src="${receta.imagenUrl}" alt="Foto de ${receta.titulo}" class="w-full h-40 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/FFFFFF?text=Imagen+no+disponible';">
                        <div class="p-6 flex flex-col flex-grow">
                            <h3 class="text-xl font-bold mb-2">${receta.titulo}</h3>
                            <p class="text-gray-600 mb-4 flex-grow">${receta.descripcion}</p>
                            <button data-id="${receta.id}" class="ver-receta-btn mt-auto w-full bg-gray-800 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-900 transition">Ver Receta Completa</button>
                        </div>
                    `;
                    cardsContainer.appendChild(card);
                });
            } else {
                 cardsContainer.innerHTML = `<p class="text-center col-span-full text-gray-600 mt-8">Lo siento, no encontré recetas con "${userInput}". ¡Intenta con otro ingrediente!</p>`;
            }
        }
        
        function mostrarRecetaCompleta(idReceta) {
            const receta = baseDeRecetas.find(r => r.id === idReceta);
            if (!receta) return;

            const comensalesSeleccionados = parseInt(comensalesInput.value, 10);
            const factorEscala = comensalesSeleccionados / receta.porcionesBase;

            const ingredientesEscaladosHTML = receta.ingredientes.map(ing => {
                let cantidadEscalada = ing.cantidad;
                const cantidadNumerica = parseFloat(ing.cantidad.replace(',', '.'));

                if (!isNaN(cantidadNumerica)) {
                    cantidadEscalada = (cantidadNumerica * factorEscala).toFixed(1);
                    if (cantidadEscalada.endsWith('.0')) {
                        cantidadEscalada = cantidadEscalada.substring(0, cantidadEscalada.length - 2);
                    }
                }
                
                return `
                    <li class="ingredient-item">
                        <label class="flex items-center cursor-pointer">
                            <input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-orange-600 focus:ring-orange-500 mr-3">
                            <span><strong>${cantidadEscalada} ${ing.unidad}</strong> de ${ing.nombre}</span>
                        </label>
                    </li>
                `;
            }).join('');

            recetaContenido.innerHTML = `
                <img src="${receta.imagenUrl}" alt="Foto de ${receta.titulo}" class="w-full h-64 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/800x400/cccccc/FFFFFF?text=Imagen+no+disponible';">
                <div class="p-6 md:p-10">
                    <h2 class="text-3xl md:text-4xl font-bold mb-2">${receta.titulo}</h2>
                    <p class="text-lg text-gray-600 mb-6">${receta.descripcion}</p>
                    
                    <div class="flex flex-wrap gap-4 text-center bg-orange-50 p-4 rounded-lg mb-8">
                        <div class="flex-1">
                            <p class="text-sm text-gray-500"><i class="fa-solid fa-list-check mr-2"></i>PREPARACIÓN</p>
                            <p class="font-bold">${receta.tiempoPrep}</p>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm text-gray-500"><i class="fa-solid fa-clock mr-2"></i>COCCIÓN</p>
                            <p class="font-bold">${receta.tiempoCoccion}</p>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm text-gray-500"><i class="fa-solid fa-users mr-2"></i>PORCIONES</p>
                            <p class="font-bold">${comensalesSeleccionados}</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div class="md:col-span-1">
                            <h3 class="text-xl font-bold mb-4 border-b-2 border-orange-500 pb-2">Ingredientes</h3>
                            <ul class="space-y-3">
                                ${ingredientesEscaladosHTML}
                            </ul>
                        </div>
                        <div class="md:col-span-2">
                            <h3 class="text-xl font-bold mb-4 border-b-2 border-orange-500 pb-2">Preparación</h3>
                            <ol class="space-y-4">
                                ${receta.pasos.map((paso, index) => `
                                    <li class="flex">
                                        <span class="bg-orange-600 text-white rounded-full h-8 w-8 text-lg flex items-center justify-center font-bold mr-4 flex-shrink-0">${index + 1}</span>
                                        <p class="pt-1">${paso}</p>
                                    </li>
                                `).join('')}
                            </ol>
                        </div>
                    </div>
                </div>
            `;
            mostrarPagina(paginaRecetaCompleta);
        }

        function volverAlBuscador() {
            ingredientesInput.value = '';
            comensalesInput.value = 2;
            mostrarPagina(paginaPrincipal);
        }

        // --- INICIO DE LA LÓGICA "SORPRÉNDEME" ---
        function sorprenderUsuario() {
            // Lista de ingredientes populares para la función "Sorpréndeme"
            const ingredientesSugeridos = ["papa", "pollo", "lentejas", "acelga", "batata", "palta", "arroz"];
            // Elegir uno al azar
            const ingredienteAzar = ingredientesSugeridos[Math.floor(Math.random() * ingredientesSugeridos.length)];
            // Colocarlo en el input
            ingredientesInput.value = ingredienteAzar;
            // Ejecutar la búsqueda
            buscarRecetas();
        }
        // --- FIN DE LA LÓGICA "SORPRÉNDEME" ---

        // --- ASIGNACIÓN DE EVENTOS ---
        buscarBtn.addEventListener('click', buscarRecetas);
        volverABuscarBtn.addEventListener('click', volverAlBuscador);
        volverAResultadosBtn.addEventListener('click', () => mostrarPagina(paginaResultados));
        sorprendemeBtn.addEventListener('click', sorprenderUsuario); // <-- Se asigna el evento
        
        document.addEventListener('click', function(e) {
            if (e.target && e.target.classList.contains('ver-receta-btn')) {
                const id = e.target.getAttribute('data-id');
                mostrarRecetaCompleta(id);
            }
        });
    </script>

</body>
</html>
